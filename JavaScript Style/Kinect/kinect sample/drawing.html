<html>
<head>
<script src="https://cdn.socket.io/socket.io-1.3.5.js"></script>
<script>
var socket = io.connect('http://localhost:8000/');
socket.on('bodyFrame', interpretData);
function interpretData(bodyFrame) {
    // Web Socket message:
	var user;
	
	// assigns a specific body to be the user
	for(i=0; i<=7;i++){
	if (bodyFrame.bodies[i]){
		user=bodyFrame.bodies[i];
		
	}
	//determines the state of the right hand an sets the painting color based on that
	switch (user.rightHandState)
    {
        case 2:
			document.getElementById("grab").innerHTML = "Right is open";
			ctx.fillStyle="Purple";
			break;
        case 3:
			document.getElementById("grab").innerHTML = "Right is closed";
			ctx.fillStyle="Green";
            break;
        case 4:
            break;
        case 0:
			document.getElementById("grab").innerHTML = "I dont know what your doing with your right hand";
            break;
        case 1:
            break;
        default:
            break;
    }
	
	//determines the state of the left hand an sets the painting color based on that
    switch (user.leftHandState)
    {
        case 2:
			document.getElementById("grab1").innerHTML = "left is open";
			ctx.fillStyle="BLUE";
			
            break;
        case 3:
			document.getElementById("grab1").innerHTML = "left is closed";
			ctx.fillStyle="RED";
			
            break;
        case 4:
            break;
        case 0:
			document.getElementById("grab1").innerHTML = "I dont know what your doing with your left hand";
            break;
        case 1:
            break;
        default:
            break;
    } 
	
	//next segment attempts to determine and track the position of the right and left hands and display that in the html body
	try{
	var rightHandPositionX = user.joints[11].depthX;
	var rightHandPositionY = user.joints[11].depthY;
	
	var leftHandPositionX = user.joints[7].depthX;
	var leftHandPositionY = user.joints[7].depthY;
	document.getElementById("dab").innerHTML = rightHandPositionX+"X , "+rightHandPositionY+" Y";
	document.getElementById("dab1").innerHTML = leftHandPositionX+"X , "+leftHandPositionY+" Y";
	
	//draws filled rectangles at the position of the hands
	ctx.fillRect(leftHandPositionX*canvasWidth, leftHandPositionY*canvasHeight,5,5);
	ctx.fillRect(rightHandPositionX*canvasWidth, rightHandPositionY*canvasHeight,5,5);
	
	//cleans canvas each frame and redraws hand images
	ctx.clearRect(0,0,canvasWidth,canvasHeight);
	if(imageLoaded){
		ctx.drawImage(hand, leftHandPositionX*canvasWidth, leftHandPositionY*canvasHeight);
		ctx.drawImage(hand, rightHandPositionX*canvasWidth, rightHandPositionY*canvasHeight);
	
	
	}
	
	}
	catch(exception){
	}
	

}
}


</script>
</head>
<body>

<div id = "dab"> </div>
<div id = "grab"> </div>
<div id = "dab1"> </div>
<div id = "grab1"> </div>
<style type="text/css">
      canvas { border: 1px solid black; }
    </style>

<script>
//creates canvas element and ataches it to the body of the html Document
var canv = document.createElement('canvas');
canv.id = 'myCanvas';
canv.width=480;
canv.height=640;
document.body.appendChild(canv);


var canvas = document.getElementById('myCanvas');
var canvasWidth = canvas.width;
var canvasHeight = canvas.height;
var ctx = canvas.getContext("2d");

var imageLoaded = false;
var hand = new Image();
hand.src='../../../hand.png';
hand.onload = function(){
imageLoaded=true;
ctx.drawImage(hand,0,0);
}

</script>

</body>
</html>